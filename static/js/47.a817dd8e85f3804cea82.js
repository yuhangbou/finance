webpackJsonp([47],{lx4h:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("4YfN"),a=i.n(n),o={name:"xianjinliuliangbiao",mixins:[i("IfhF").a],filters:{hao:function(t){return t+" 号"}},data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()<new Date(JSON.parse(localStorage.getItem("start_date")))-864e5}},tableData_daochu:[],kehuming:[],renzhengriqiId:"",img:"",dialogVisible:!1,dialogFormVisible:!1,tableData:[],total:0,dangqianye:1,pageSize:10,multi:"",form:{supplierName:"",date:"",invoiceNumber:"",type:"",startDay:"",endDay:"",renzhengriqi:""}}},mounted:function(){var t=this;this.getStorage(),this.list(),this._ajax("userAccounts/selectCompanySupplierName",{company_supplier_name:"",uuid:this.uuid,workAccountId:this.accountId},function(e){t.kehuming=e})},methods:{daochu:function(){var t=this;this._ajax("zip/selectAllInvoice11",a()({uuid:this.uuid,workAccountId:this.accountId},this.form),function(e){t.tableData_daochu=e,setTimeout(function(){t.exportFunc("daochu","发票报表")},1e3)})},shengcheng_pingzheng:function(t){this.$router.push({path:"/home/pingzhengguanli/add_pingzheng",query:{invoiceId:t,from:"fapiaoguanli"}})},change_date:function(){console.log(this.form.date),null!=this.form.date?(this.form.startDay=new Date(this.form.date[0]).getFullYear()+"-"+(Array(2).join(0)+(Number(new Date(this.form.date[0]).getMonth())+1)).slice(-2)+"-"+(Array(2).join(0)+new Date(this.form.date[0]).getDate()).slice(-2),this.form.endDay=new Date(this.form.date[1]).getFullYear()+"-"+(Array(2).join(0)+(Number(new Date(this.form.date[1]).getMonth())+1)).slice(-2)+"-"+(Array(2).join(0)+new Date(this.form.date[1]).getDate()).slice(-2)):(this.form.startDay="",this.form.endDay="")},search:function(){this.dangqianye=1,this.list()},renzhengriqi_ok:function(){var t=this;this._ajax("userAccounts/updateUserInvoice",{uuid:this.uuid,workAccountId:this.accountId,authenticationDate:this.form.renzhengriqi,invoiceId:this.renzhengriqiId},function(e){t._message(1,"认证成功"),t.dialogFormVisible=!1,t.list()})},handleSelectionChange:function(t){var e=t.map(function(t){return t.invoiceId});this.multi=e.join(",")},del:function(){var t=this;this._ajax("userAccounts/deleteUserInvoice",{uuid:this.uuid,workAccountId:this.accountId,invoiceId:this.multi},function(e){t._message(1,"删除成功"),t.list(),t.multi=""})},del_many:function(){""!=this.multi?this.del():this._message(2,"请至少选择一项")},del_one:function(t){this.multi=t,this.del()},list:function(){var t=this;this._ajax("userAccounts/selectUserInvoice",a()({uuid:this.uuid,workAccountId:this.accountId,page:this.dangqianye,pageSize:this.pageSize},this.form),function(e){t.total=e.PageInfo.total,t.tableData=e.PageInfo.list})},jiechu_liushui:function(t,e){var i=this;this._ajax("userAccounts/deleteInvoiceFlowing",{uuid:this.uuid,workAccountId:this.accountId,invoiceId:t,accountingId:e},function(t){i._message(1,"取消关联流水成功"),i.list()})},guanlian_liushui:function(t){this.$router.push({path:"/home/fapiao/pipeixianyouliushui",query:{invoiceId:t,from:"fapiaoguanli"}})},jiechu_pingzheng:function(t,e){var i=this;this._ajax("userAccounts/deleteInvoiceCrtificate",{uuid:this.uuid,workAccountId:this.accountId,invoiceId:t,certificateUuid:e},function(t){i._message(1,"取消关联凭证成功"),i.list()})},guanlian_pingzheng:function(t){this.$router.push({path:"/home/fapiao/pipeixianyoupingzheng",query:{invoiceId:t,from:"fapiaoguanli"}})},look:function(t){this.img=t,this.dialogVisible=!0},renzheng:function(t,e){this.form.renzhengriqi=t,this.renzhengriqiId=e,this.dialogFormVisible=!0},tableRowClassName:function(t){t.row;return t.rowIndex%2!=0?"lan":""},handleSizeChange:function(t){console.log("每页 "+t+" 条"),this.pageSize=t,this.list()},handleCurrentChange:function(t){console.log("当前页: "+t),this.dangqianye=t,this.list()},handleClick:function(t){this.$router.push({path:"/home/fapiao/fapiaoguanli_xiugai",query:{invoiceId:t}})}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticStyle:{background:"#FFF",padding:"2vh 2vw"}},[i("div",{staticStyle:{"font-size":"30px",color:"#1C2023","text-align":"center"}},[t._v("发票管理")]),t._v(" "),i("div",{staticStyle:{border:"1px solid #F8F8FF",padding:"2vh 2vw","margin-top":"2vh"}},[i("div",[i("el-form",{staticStyle:{display:"flex","flex-wrap":"wrap"},attrs:{"label-width":"70px",inline:!0,model:t.form}},[i("div",{staticClass:"right"},[i("el-button",{attrs:{type:"warning"},on:{click:function(e){return t.$router.push({path:"/home/pingzhengguanli/xinzengfapiao",query:{from:"fapiaoguanli",no_show_storage:1}})}}},[t._v("上传发票")])],1),t._v(" "),i("div",{staticClass:"right"},[i("el-button",{attrs:{type:"warning"},on:{click:t.del_many}},[t._v("删除")])],1),t._v(" "),i("div",[i("el-button",{attrs:{type:"warning"},on:{click:t.daochu}},[t._v("导出")])],1),t._v(" "),i("div",{staticClass:"right"},[i("el-form-item",{attrs:{label:"方向"}},[i("el-select",{staticStyle:{width:"90px"},attrs:{placeholder:"请选择",clearable:""},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[i("el-option",{attrs:{label:"收",value:"客户"}}),t._v(" "),i("el-option",{attrs:{label:"支",value:"供应商"}})],1)],1)],1),t._v(" "),i("div",{staticClass:"right"},[i("el-form-item",{attrs:{label:"发票号码"}},[i("el-input",{attrs:{placeholder:""},model:{value:t.form.invoiceNumber,callback:function(e){t.$set(t.form,"invoiceNumber",e)},expression:"form.invoiceNumber"}})],1)],1),t._v(" "),i("div",{staticClass:"right"},[i("el-form-item",{attrs:{label:"客户名","label-width":"60px"}},[i("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:t.form.supplierName,callback:function(e){t.$set(t.form,"supplierName",e)},expression:"form.supplierName"}},t._l(t.kehuming,function(t){return i("el-option",{key:t.company_supplier_name,attrs:{label:t.company_supplier_name,value:t.company_supplier_name}})}),1)],1)],1),t._v(" "),i("div",{staticClass:"right"},[i("el-date-picker",{staticStyle:{width:"230px"},attrs:{"picker-options":t.pickerOptions,type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.change_date},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),i("div",{staticClass:"right"},[i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.search}},[t._v("搜索")])],1)])],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{id:"daochu"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData_daochu}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{prop:"",label:"发票类型",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.company_invoice_type?i("span",[t._v("专票")]):1==e.row.company_invoice_type?i("span",[t._v("普票")]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"120",prop:"invoicing_date",label:"开票日期"}}),t._v(" "),i("el-table-column",{attrs:{width:"100",prop:"authentication_date",label:"认证日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.company_invoice_type?i("span",[t._v(t._s(e.row.authentication_date))]):i("span",[null==e.row.authentication_date?i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.renzheng(e.row.authentication_date,e.row.invoiceId)}}},[t._v("认证")]):t._e(),t._v(" "),null!=e.row.authentication_date?i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.renzheng(e.row.authentication_date,e.row.invoiceId)}}},[t._v(t._s(e.row.authentication_date)+"修改")]):t._e()])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"company_invoice_number",label:"发票号码",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"company_supplier_name",label:"供应商/客户名称",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"company_supplier_type",label:"方向",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{width:"100",prop:"money",label:"金额"}}),t._v(" "),i("el-table-column",{attrs:{width:"100",prop:"tax_rate",label:"税率"}}),t._v(" "),i("el-table-column",{attrs:{width:"100",prop:"price_tax_total",label:"价税合计"}}),t._v(" "),i("el-table-column",{attrs:{width:"100",prop:"invoice_photo",label:"图片"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.look(e.row.invoice_photo)}}},[t._v("查看")])])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"130",prop:"accountingId",label:"关联流水"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.accountingId?i("span",[t._v("\n                                已关联\n                                "),i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.jiechu_liushui(e.row.invoiceId,e.row.accountingId)}}},[t._v("解除关联")])]):i("span",[i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.guanlian_liushui(e.row.invoiceId)}}},[t._v("关联")])])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"130",prop:"certificateUuid",label:"关联凭证"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.certificateUuid?i("span",[t._v("\n                                "+t._s(t._f("hao")(e.row.certificate_number))+"\n                                "),i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.jiechu_pingzheng(e.row.invoiceId,e.row.certificateUuid)}}},[t._v("解除关联")])]):i("span",[i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.shengcheng_pingzheng(e.row.invoiceId)}}},[t._v("生成")]),t._v(" "),i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.guanlian_pingzheng(e.row.invoiceId)}}},[t._v("关联")])])]}}])})],1)],1),t._v(" "),i("div",{attrs:{id:"id"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"row-class-name":t.tableRowClassName},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{prop:"",label:"发票类型",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.company_invoice_type?i("span",[t._v("专票")]):1==e.row.company_invoice_type?i("span",[t._v("普票")]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"120",prop:"invoicing_date",label:"开票日期"}}),t._v(" "),i("el-table-column",{attrs:{width:"100",prop:"authentication_date",label:"认证日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.company_invoice_type?i("span",[t._v(t._s(e.row.authentication_date))]):i("span",[null==e.row.authentication_date?i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.renzheng(e.row.authentication_date,e.row.invoiceId)}}},[t._v("认证")]):t._e(),t._v(" "),null!=e.row.authentication_date?i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.renzheng(e.row.authentication_date,e.row.invoiceId)}}},[t._v(t._s(e.row.authentication_date)+"修改")]):t._e()])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"company_invoice_number",label:"发票号码",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"company_supplier_name",label:"供应商/客户名称",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"company_supplier_type",label:"方向",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{width:"100",prop:"money",label:"金额"}}),t._v(" "),i("el-table-column",{attrs:{width:"100",prop:"tax_rate",label:"税率"}}),t._v(" "),i("el-table-column",{attrs:{width:"100",prop:"price_tax_total",label:"价税合计"}}),t._v(" "),i("el-table-column",{attrs:{width:"100",prop:"invoice_photo",label:"图片"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.look(e.row.invoice_photo)}}},[t._v("查看")])])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"130",prop:"accountingId",label:"关联流水"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.accountingId?i("span",[t._v("\n                                已关联\n                                "),i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.jiechu_liushui(e.row.invoiceId,e.row.accountingId)}}},[t._v("解除关联")])]):i("span",[i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.guanlian_liushui(e.row.invoiceId)}}},[t._v("关联")])])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"130",prop:"certificateUuid",label:"关联凭证"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.certificateUuid?i("span",[t._v("\n                                "+t._s(t._f("hao")(e.row.certificate_number))+"\n                                "),i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.jiechu_pingzheng(e.row.invoiceId,e.row.certificateUuid)}}},[t._v("解除关联")])]):i("span",[i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.shengcheng_pingzheng(e.row.invoiceId)}}},[t._v("生成")]),t._v(" "),i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.guanlian_pingzheng(e.row.invoiceId)}}},[t._v("关联")])])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return t.handleClick(e.row.invoiceId)}}},[t._v("修改")]),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return t.del_one(e.row.invoiceId)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),i("div",{staticStyle:{display:"flex","justify-content":"flex-end","margin-top":"1vh"}},[i("el-pagination",{attrs:{"current-page":t.dangqianye,"page-sizes":[10,20,30,40],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])]),t._v(" "),i("el-dialog",{attrs:{title:"",visible:t.dialogFormVisible,width:"20%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{attrs:{model:t.form}},[i("el-form-item",{attrs:{label:"认证日期"}},[i("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:t.form.renzhengriqi,callback:function(e){t.$set(t.form,"renzhengriqi",e)},expression:"form.renzhengriqi"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.renzhengriqi_ok}},[t._v("确 定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("img",{staticStyle:{width:"100%"},attrs:{src:t.img,alt:""}})])],1)},staticRenderFns:[]};var l=i("C7Lr")(o,r,!1,function(t){i("vzbP")},null,null);e.default=l.exports},vzbP:function(t,e){}});
//# sourceMappingURL=47.a817dd8e85f3804cea82.js.map
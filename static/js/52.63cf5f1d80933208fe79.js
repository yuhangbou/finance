webpackJsonp([52],{YWSl:function(e,t){},ZDDi:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("3cXf"),o=i.n(a),n=i("IfhF"),s=i("nqNp"),l={name:"xianjinliuliangbiao",mixins:[n.a],components:{pingzheng:s.a},data:function(){return{yaoxinxi:!1,qimo_editor_fanxian:"",certificate_uuid:"",flag1:"",flag2:"",form:{code:"",date:""},user:{tableData:[]},dialogVisible:!1,tableData1:[],id:"",page:1,pageSize:10,total:0}},mounted:function(){this.getStorage(),this.get_jiezhuan_date(),this.fanxian(),1==this.$route.query.number&&(this.title="添加销售成本凭证"),2==this.$route.query.number&&(this.title="添加职工薪酬凭证"),3==this.$route.query.number&&(this.title="添加固定资产折旧凭证"),4==this.$route.query.number&&(this.title="添加长期摊销凭证"),5==this.$route.query.number&&(this.title="添加计提税金凭证")},methods:{geixinxi:function(e,t){this.user=e,this.ok()},ok:function(){var e=this;if(isNaN(Number(this.form.code))||Number(this.form.code)<=0)this._message(2,"凭证字号格式不正确");else{var t="",i="",a="",o="",n="";this.user.tableData.forEach(function(e){t+=e.zhaiyao+",",""==e.jie?i+="0,":i+=e.jie+",",""==e.dai?a+="0,":a+=e.dai+",",e.name.split(",")[0].includes("-")?o+=e.name.split(",")[0].split("-")[1]+",":o+=e.name.split(",")[0]+",",n+=e.name.split(",")[1]+","}),this._ajax("userAccounts/updateCertificate",{uuid:this.uuid,workAccountId:this.accountId,debitMoney:i,creditMoney:a,subject:o,code:n,certificateAbstract:t,flag1:this.flag1,flag2:this.flag2,certificateNumber:this.form.code,time:this.form.date,certificateUuid:this.certificate_uuid},function(t){e._message(1,"修改成功"),e.$router.push("/home/qimojiezhuan/one"),e.clear()})}},fanxian:function(){var e=this;this._ajax("userHomePage/selectOverCertificate",{uuid:this.uuid,workAccountId:this.accountId,time:this.jiezhuan_date+"-"+(Array(2).join(0)+(new Date).getDate()).slice(-2),flag1:this.$route.query.number},function(t){e.flag1=t[0].flag1,e.flag2=t[0].flag2,e.form.code=t[0].certificate_number,e.form.date=t[0].creationTime,e.certificate_uuid=t[0].certificate_uuid;var i=[];t.forEach(function(e,t){var a={name:e.new_subjects_name+","+e.accountant_code,zhaiyao:e.certificate_abstract,jie:"",dai:"",index:t,jie_show:!1,dai_show:!1};0==e.total_credit_money&&(a.dai_show=!0,a.jie=e.total_debit_money),0==e.total_debit_money&&(a.jie_show=!0,a.dai=e.total_credit_money),i.push(a)}),e.index=t.length-1,e.user.tableData=i,e.qimo_editor_fanxian=i})},clear:function(){sessionStorage.removeItem("type1"),sessionStorage.removeItem("fapiao")},pingzhengzihao:function(){var e=this;this._ajax("userHomePage/selectCertificateNumber",{uuid:this.uuid,workAccountId:this.accountId,time:this.form.date},function(t){e.form.code=t.number})},congxianyoupiaojuxuanze:function(){this.list_bind()},list_bind:function(){var e=this;this._ajax("userAccounts/selectNoInvoice",{uuid:this.uuid,workAccountId:this.accountId,page:this.page,pageSize:this.pageSize},function(t){e.tableData1=t.PageInfo.list,e.total=t.PageInfo.total,e.dialogVisible=!0})},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.pageSize=e,this.list_bind()},handleCurrentChange:function(e){console.log("当前页: "+e),this.dangqianye=e,this.list_bind()},dialogVisible_ok:function(){0!=this.id?(sessionStorage.setItem("fapiao",o()(this.id)),sessionStorage.setItem("type1","pipei_fapiao"),this.dialogVisible=!1):this._message(2,"请选择一个")}}},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticStyle:{background:"#FFF",padding:"2vh 2vw"}},[i("div",{staticStyle:{"font-size":"30px",color:"#1C2023","text-align":"center"}},[e._v("修改凭证")]),e._v(" "),i("div",{staticStyle:{border:"1px solid #F8F8FF",padding:"2vw","margin-top":"2vh"}},[i("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"flex-start"}},[i("div",[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.form}},[i("el-form-item",{attrs:{label:"凭证字号："}},[i("el-input",{attrs:{placeholder:""},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"号"}}),e._v(" "),i("el-form-item",{attrs:{label:"日期："}},[i("el-date-picker",{attrs:{type:"date",placeholder:"","value-format":"yyyy-MM-dd"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1)],1)],1)]),e._v(" "),i("pingzheng",{attrs:{yaoxinxi:e.yaoxinxi,qimo_editor_fanxian:e.qimo_editor_fanxian,type:"editor"},on:{geixinxi:e.geixinxi}}),e._v(" "),i("div",{staticStyle:{display:"flex","justify-content":"center","margin-top":"5vh"}},[i("el-button",{attrs:{type:"warning"},on:{click:function(t){e.yaoxinxi=(new Date).getTime()}}},[e._v("保存")]),e._v(" "),i("el-button",{staticStyle:{"margin-left":"5vw"},attrs:{type:"info"},on:{click:function(t){return e.$router.push({path:"/home/qimojiezhuan/one"})}}},[e._v("返回")])],1)],1)]),e._v(" "),i("el-dialog",{attrs:{title:"",visible:e.dialogVisible,"close-on-press-escape":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-table",{attrs:{data:e.tableData1}},[i("el-table-column",{attrs:{prop:"",label:"单选",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-radio",{attrs:{label:t.row.id},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}},[e._v(" ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"creation_time",label:"上传时间",width:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"company_invoice_number",label:"发票号码",width:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"company_supplier_name",label:"供应商/客户名称",width:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"price_tax_total",label:"价税合计",width:""}})],1),e._v(" "),i("div",{staticStyle:{display:"flex","justify-content":"flex-end","margin-top":"1vh"}},[i("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.dialogVisible_ok}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=i("C7Lr")(l,r,!1,function(e){i("YWSl")},null,null);t.default=c.exports}});
//# sourceMappingURL=52.63cf5f1d80933208fe79.js.map